<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_237223_mypdfgene.MySamDeyPDFviaWebServiceScriptInclude</api_name>
        <client_callable>true</client_callable>
        <description/>
        <name>MySamDeyPDFviaWebServiceScriptInclude</name>
        <script><![CDATA[var source_tableName = "sc_req_item";
var source_recordSYSID = "3194244637a32300180edcc773990e59" ;// sys id of the record's data you want to use in the pdf
var source_view  = "ess"; // View name in this case I am using the Self Service View
var target_tableName = "sc_req_item"; // In this case target and source is same, it could be different as well
var target_recordSYSID = "3194244637a32300180edcc773990e59"; // In this case target and source is same, it could be different as well
var pdfName = "Test.pdf"; // Could be anything but do mention the extension .pdf
var basicAuthenticatorSYSID = "000000007a32300180edcc773990e39"; // this is the sys id of the Basic Authentication Profile which is available from sys_auth_profile_basic_list.do table.


function generatePDFUsingREST( sourceTable, sourceID, sourceView, targetTable, targetID, fileName, authProfileSysID ) {
	var r = new sn_ws.RESTMessageV2();
	r.setHttpMethod('get');
	r.setEndpoint(gs.getProperty('glide.servlet.uri')+ sourceTable + '.do?PDF&sys_id=' + sourceID + '&sysparm_view=' + sourceView);
	r.setAuthenticationProfile('basic', authProfileSysID);
	r.saveResponseBodyAsAttachment(targetTable, targetID, fileName);            
	var response = r.execute();   
}	

var MySamDeyPDFviaWebServiceScriptInclude = Class.create();
MySamDeyPDFviaWebServiceScriptInclude.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {
    type: 'MySamDeyPDFviaWebServiceScriptInclude',
	generatePDFUsingREST: function() {
		try {
			gs.addInfoMessage("Inside the REST Script Include !!");
			gs.info("Inside the REST Script Include !!");
			genPDFUsingREST(source_tableName,source_recordSYSID,source_view,target_tableName,target_recordSYSID,pdfName,basicAuthenticatorSYSID);
			gs.addInfoMessage("AFTER Calling genPDFUsingREST() Inside the REST Script Include !!");
			gs.info("AFTER Calling genPDFUsingREST() Inside the REST Script Include !!");
		} catch (e) {
			gs.addErrorMessage("Exception Caught inside the REST Script Include: " + e);
			gs.error("Exception Caught inside the REST Script Include: " + e);
		}
	}

});]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2019-02-12 04:06:31</sys_created_on>
        <sys_id>f290450edb272300fc20112039961959</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>MySamDeyPDFviaWebServiceScriptInclude</sys_name>
        <sys_package display_value="MyPDFGeneratorTutorial" source="x_237223_mypdfgene">326d57f3db132300fc20112039961901</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="MyPDFGeneratorTutorial">326d57f3db132300fc20112039961901</sys_scope>
        <sys_update_name>sys_script_include_f290450edb272300fc20112039961959</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2019-02-12 15:49:12</sys_updated_on>
    </sys_script_include>
</record_update>
